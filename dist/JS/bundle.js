(()=>{"use strict";const e=class{constructor(e,t,o=!0,n=!0){this.modal="string"==typeof e?document.querySelector(e):e,this.btnOpen="string"==typeof t?document.querySelector(t):t,this.canClose=o,this.btnClose=this.modal.querySelector(".js-modal-close"),this.outsideClick=n,this.activeClass="js-modal-show",this.open=!1,this.bindEvents()}update=()=>{this.modal.classList.toggle(this.activeClass,this.open)};onOpen=()=>{this.open=!0,this.update(),document.addEventListener("keydown",this.onKeyDown)};onClose=()=>{this.open=!1,this.update(),document.removeEventListener("keydown",this.onKeyDown)};toggle=()=>{this.open?this.onClose():this.onOpen()};onKeyDown=e=>{"Escape"===e.key&&this.canClose&&this.onClose()};onOutsideClick=e=>{this.outsideClick&&e.target===this.modal&&this.canClose&&this.onClose()};bindEvents=()=>{this.btnOpen&&this.btnOpen.addEventListener("click",this.onOpen),this.canClose&&(this.btnClose.addEventListener("click",this.onClose),this.modal.addEventListener("click",this.onOutsideClick))};render=()=>{this.update()}},t=new e(".modal-policies",".js-modal-policies-open"),o=(new e(".modal-upload",".js-modal-upload-open"),new e(".modal-loader",".js-modal-loader-open",!1));let n=null;function s(e){const o=e.files[0];o&&(n=o,t.onOpen(),e.value="")}const l=document.querySelectorAll(".area-upload"),i=document.querySelector("#policiesAgreeBtn");document.querySelector(".result")&&function(){const e=document.querySelector(".result__content-accordion");if(!e)return;const t=e.querySelectorAll(".result__content-accordion-item");t.forEach((e=>{const o=e.querySelector(".result__content-accordion-header"),n=e.querySelector(".result__content-accordion-content");o&&n&&o.addEventListener("click",(()=>{n.style.maxHeight=`${n.scrollHeight}px`,t.forEach((t=>{t!==e&&t.classList.add("js-close")})),e.classList.toggle("js-close")}))}))}(),l.forEach((e=>{const t=e.querySelector("input[type='file']"),o=e.querySelector(".btn-upload");!function(e,t,o){o.addEventListener("click",(e=>{e.stopPropagation(),t.click()})),e.addEventListener("click",(e=>{e.target!==o&&t.click()})),t.addEventListener("change",(()=>s(t))),e.addEventListener("dragover",(t=>{t.preventDefault(),e.classList.add("drag-over")})),e.addEventListener("dragleave",(()=>{e.classList.remove("drag-over")})),e.addEventListener("drop",(o=>{o.preventDefault(),e.classList.remove("drag-over"),o.dataTransfer.files.length&&(t.value="",t.files=o.dataTransfer.files,s(t))}))}(e,t,o)})),i.addEventListener("click",(()=>{localStorage.setItem("policiesAgree","true"),t.onClose(),n&&(function(e){o.onOpen();const t=new FormData;t.append("document",e),fetch("/upload",{method:"POST",body:t}).then((e=>e.json())).then((e=>{console.log("Файл загружен!",e),setTimeout((()=>{o.onClose()}),3e3)})).catch((e=>{setTimeout((()=>{o.onClose()}),3e3),console.error("Ошибка загрузки",e)}))}(n),n=null)})),function(){const e=document.querySelectorAll("[data-mob]");e&&window.innerWidth<=768&&e.forEach((e=>{e.setAttribute("src",e.getAttribute("data-mob"))}))}(),document.querySelector(".modal-loader-show")&&o.onOpen()})();